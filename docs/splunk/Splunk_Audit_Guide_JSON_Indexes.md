# üßæ Splunk Audit Guide ‚Äî JSON Log Verification

## üìò Purpose
This document provides auditors with clear steps to **view and filter JSON logs** in Splunk for the following indexes:
- `browser_updates_servers` ‚Äî JSON logs from browser update scripts  
- `defender_update_servers` ‚Äî JSON logs from Windows Defender definition updates  

---

## üß≠ Accessing Splunk
1. Open your Splunk Web Console  
   ```
   https://splunk-server:8000
   ```
2. Log in using your Splunk credentials.
3. From the **Search & Reporting** app, open a new search window.

---

## üìÇ Index Overview
| Index | Description | Typical JSON Fields |
|:--|:--|:--|
| `browser_updates_servers` | Logs generated by browser update scripts on servers. | `host`, `browser`, `status`, `version`, `timestamp` |
| `defender_update_servers` | Logs generated by Windows Defender signature update tasks. | `host`, `status`, `definition_version`, `result`, `timestamp` |

---

## üîç Basic Search Examples

### 1. View All Events in Each Index
```spl
index=browser_updates_servers
```
```spl
index=defender_update_servers
```

> **Tip:** Adjust time range (top right corner of the search page) to the desired audit window ‚Äî e.g., ‚ÄúLast 7 days‚Äù or ‚ÄúLast 24 hours‚Äù.

---

### 2. Filter by Hostname Inside JSON
If logs contain a JSON field named `host`, `Host`, or `hostname`:

```spl
index=browser_updates_servers | spath | search host="fps01"
```
or (for Defender logs):
```spl
index=defender_update_servers | spath | search host="fps01"
```

> `spath` extracts JSON fields so you can query nested keys like `system.host` or `device.hostname`.

---

### 3. Filter by Status or Result
```spl
index=browser_updates_servers | spath | search status="ok"
```
```spl
index=defender_update_servers | spath | search result="success"
```

---

### 4. Display Key Fields in a Table
```spl
index=browser_updates_servers
| spath
| table _time host browser version status
| sort -_time
```
```spl
index=defender_update_servers
| spath
| table _time host definition_version status result
| sort -_time
```

---

### 5. Filter by Multiple Conditions
```spl
index=browser_updates_servers | spath | search host="fps01" status="failed"
```
```spl
index=defender_update_servers | spath | search host="fps01" result!="success"
```

---

## üß† Tips for Auditors
- **`spath`**: Always use this for JSON logs ‚Äî it ensures Splunk extracts nested keys correctly.  
- **Case sensitivity**: Field names in JSON are case-sensitive (`Host` ‚â† `host`).  
- **Save searches**: After running a query, click **Save As ‚Üí Report** to reuse it later.  
- **Export results**: Click **Export ‚Üí CSV** for inclusion in audit packages.

---

## üß© Troubleshooting
| Issue | Cause | Resolution |
|:--|:--|:--|
| No results shown | Time range too narrow | Expand time picker (e.g., ‚ÄúLast 30 days‚Äù) |
| Fields missing | JSON not parsed | Add `| spath` to extract fields |
| Duplicate host field | Metadata host vs JSON host | Use `search host="fps01"` (metadata) or `"json.host"="fps01"` if nested |
| Index not found | Index permission missing | Request access to both indexes from Splunk admin |

---

## ‚úÖ Verification Checklist
- [ ] Can access both indexes in Splunk  
- [ ] Verified events appear for sample host `fps01`  
- [ ] Confirmed JSON fields (`host`, `status`, etc.) extract correctly  
- [ ] Successfully filtered by date, host, and result  
- [ ] Exported search results for recordkeeping  
